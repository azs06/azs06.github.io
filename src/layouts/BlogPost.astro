---
import type { CollectionEntry } from "astro:content";
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import FormattedDate from "../components/FormattedDate.astro";

import GoogleTag from "../components/GoogleTag.astro";

type Props = CollectionEntry<"blog">["data"];

// Destructure incoming props so template references (title, description, etc.) are defined
const { title, description, pubDate, tags, updatedDate }: Props =
  Astro.props;

const readingTime = 5; // Default to 5 minutes for now
---

<html lang="en">
  <head>
    <BaseHead title={title} description={description} />
    <GoogleTag />
  </head>
  <body class="bg-white dark:bg-gray-900 transition-colors duration-300">
    <Header />
    <main class="max-w-6xl mx-auto px-4 py-12">
      <article class="space-y-8">
        <!-- Back link -->
        <div class="section-animate">
          <a
            href="/blog"
            class="inline-flex items-center gap-2 text-sm text-muted dark:text-gray-400 hover:text-accent dark:hover:text-accent transition-colors"
          >
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M19 12H5M12 19l-7-7 7-7"></path>
            </svg>
            Back to blog
          </a>
        </div>

        <!-- Article header -->
        <header class="section-animate space-y-6">
          <h1 class="text-4xl font-bold text-primary dark:text-gray-100 font-serif">
            {title}
          </h1>

          <div class="flex flex-wrap items-center gap-4 text-sm text-muted dark:text-gray-400">
            <time><FormattedDate date={pubDate} /></time>
            <span class="text-border dark:text-gray-600">•</span>
            <span>{readingTime} min read</span>
            {
              updatedDate && (
                <>
                  <span class="text-border dark:text-gray-600">•</span>
                  <span class="text-xs italic">
                    Updated <FormattedDate date={updatedDate} />
                  </span>
                </>
              )
            }
          </div>

          {
            tags && tags.length > 0 && (
              <div class="flex flex-wrap gap-2">
                {tags.map((tag: string) => (
                  <span class="px-2 py-1 text-xs text-muted dark:text-gray-400 bg-surface dark:bg-[#2a2520] border border-border/50 dark:border-[#3d352d] rounded font-sans">
                    {tag}
                  </span>
                ))}
              </div>
            )
          }
        </header>

        <!-- Article content -->
        <div class="section-animate pt-8 border-t border-border dark:border-[#3d352d]">
          <div class="markdown-body">
            <slot />
          </div>
        </div>
      </article>
    </main>
    <Footer />
  </body>
</html>
