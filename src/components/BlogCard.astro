---
import FormattedDate from "./FormattedDate.astro";
import type { CollectionEntry } from "astro:content";

interface Props {
  post: CollectionEntry<"blog">;
}

const { post } = Astro.props;
const { data } = post;
const slug = post.id;
const tags = data.tags ?? [];
const description = data.description ?? "";
const href = `/blog/${slug}/`;
---

<article
  class="blog-post stagger-item card-lift group flex flex-col p-4 border border-border dark:border-[#3d352d] rounded-lg bg-paper/50 dark:bg-[#2a2520]/50 hover:border-accent/50 dark:hover:border-accent/50"
  data-title={data.title.toLowerCase()}
  data-description={description.toLowerCase()}
  data-tags={tags.map(t => t.toLowerCase()).join(',')}
>
  <div class="flex flex-col gap-2">
    <span class="text-xs text-muted dark:text-gray-500 font-sans">
      <FormattedDate date={data.pubDate} />
    </span>
    <a href={href} class="space-y-2">
      <h3 class="font-medium text-primary dark:text-gray-100 group-hover:text-accent transition-colors font-serif">
        {data.title}
      </h3>
      {description && (
        <p class="text-sm text-muted dark:text-gray-400 line-clamp-2">
          {description}
        </p>
      )}
    </a>
    {tags.length > 0 && (
      <div class="flex flex-wrap gap-1.5 mt-2">
        {tags.slice(0, 3).map((tag) => (
          <span class="px-2 py-0.5 text-xs text-muted dark:text-gray-400 bg-surface dark:bg-[#2a2520] border border-border/50 dark:border-[#3d352d] rounded font-sans">
            {tag}
          </span>
        ))}
      </div>
    )}
  </div>
</article>
